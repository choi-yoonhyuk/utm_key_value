<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTM 옵션 마스터 목록</title>
    <style>
        body { font-family: sans-serif; margin: 20px; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; table-layout: fixed; /* 테이블 레이아웃 고정 */ }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; vertical-align: top; word-wrap: break-word; /* 긴 내용 자동 줄바꿈 */ }
        th { background-color: #f0f0f0; position: sticky; top: 0; z-index: 1;} /* 헤더 고정 */
        #loadingStatus { font-style: italic; color: #777; margin-bottom: 15px; }
        #tableContainerWrapper { max-height: 70vh; overflow-y: auto; border: 1px solid #ddd; } /* 테이블 영역 스크롤 */
    </style>
</head>
<body>
    <h1>UTM 옵션 마스터 목록</h1>
    <p id="loadingStatus">데이터 로딩 중...</p>
    <div id="tableContainerWrapper">
        <div id="optionsTableContainer">
            </div>
    </div>

    <script>
        // 1. "옵션 마스터 시트"의 CSV 웹 게시 URL (반드시 실제 URL로 교체!)
        const MASTER_OPTIONS_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vShcppno7HuVQbjoQzbaBMEvoBGt6atss9FI_-F3qSh_pzgtxw7A4NPo6Y2EYoll2y5_8wMt08X_oV0/pub?gid=1861589139&single=true&output=csv';
        // 예시: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vYOUR_SHEET_ID/pub?gid=YOUR_GID&single=true&output=csv';

        // 2. 페이지가 완전히 로드되면 실행될 함수
        document.addEventListener('DOMContentLoaded', async () => {
            const loadingStatusEl = document.getElementById('loadingStatus');
            const tableContainerEl = document.getElementById('optionsTableContainer');

            if (!MASTER_OPTIONS_CSV_URL || MASTER_OPTIONS_CSV_URL === '여기에_사용자님의_옵션_마스터_시트_CSV_게시_URL을_넣으세요') {
                loadingStatusEl.textContent = "오류: 구글 시트 CSV URL이 설정되지 않았습니다. 스크립트에서 MASTER_OPTIONS_CSV_URL 변수를 수정해주세요.";
                loadingStatusEl.style.color = "red";
                return;
            }
            
            try {
                loadingStatusEl.textContent = "옵션 목록 로딩 중...";
                const response = await fetch(MASTER_OPTIONS_CSV_URL); 

                if (!response.ok) {
                    throw new Error(`마스터 옵션 CSV 로드 실패 (상태 코드: ${response.status})`);
                }

                const csvDataText = await response.text(); 
                
                if (!csvDataText) {
                    loadingStatusEl.textContent = "옵션 데이터가 비어있습니다.";
                    return;
                }

                const tableElement = createTableFromCsv(csvDataText);
                tableContainerEl.innerHTML = ''; 
                tableContainerEl.appendChild(tableElement); 
                loadingStatusEl.style.display = 'none'; 

            } catch (error) {
                console.error("마스터 옵션 로딩 또는 표시 오류:", error);
                loadingStatusEl.textContent = `오류: ${error.message}`;
                loadingStatusEl.style.color = "red";
                tableContainerEl.innerHTML = '<p>옵션 목록을 불러오는 데 실패했습니다. 개발자 콘솔(F12)을 확인해주세요.</p>';
            }
        });

        // 3. CSV 텍스트를 HTML 테이블 요소로 변환하는 함수
        function createTableFromCsv(csvDataText) {
            const lines = csvDataText.split(/\r?\n/); 
            const table = document.createElement('table');

            if (lines.length === 0) {
                return table; 
            }

            // 첫 번째 줄을 헤더로 사용
            const headers = lines[0].split(',').map(header => header.trim().replace(/^"|"$/g, ''));
            const thead = table.createTHead();
            const headerRow = thead.insertRow();
            headers.forEach(headerText => {
                const th = document.createElement('th');
                th.textContent = headerText;
                headerRow.appendChild(th);
            });

            // 두 번째 줄부터 데이터 행으로 사용 (사용자 시트에는 타입 행이 없으므로 바로 데이터)
            const tbody = table.createTBody();
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (line === "") continue; 

                const cells = line.split(',').map(cell => cell.trim().replace(/^"|"$/g, ''));
                const tr = tbody.insertRow();
                headers.forEach((header, index) => { 
                    const td = tr.insertCell();
                    td.textContent = cells[index] || ""; 
                });
            }
            return table;
        }
    </script>
</body>
</html>